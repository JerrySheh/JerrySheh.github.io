---
title: 如何造一台计算机
comments: true
categories: 技术&技巧
abbrlink: 2f0bdd16
date: 2018-12-06 18:46:28
tags:
---

> 加法计算是计算机要做的唯一的工作。

最近在读 Charles Petzold 的《编码——隐匿在计算机软硬件背后的语言》，英文书名是《Code：The Hidden Language of Computer Hardware and Software》。作者的文笔可谓是轻松风趣，第一页那句“众所周知，手电筒是为了让孩子们能够躲在被子下看书而发明的”就让我产生极大兴趣。读来发觉这本书实际上就是从最基本的电学开始讲起，一步步地教你一台原始的计算机是如何诞生的。同时也帮助我补充了不少数字电路和组成原理的知识，下面是一些笔记。

![code_book](../../../../images/code_book.jpg)

# 编码与组合

《美国传统英语词典》对编码的其中一个定义是：由被赋予了一定主观意义（arbitrary meanings）的符号、字母以及单词所组成的系统，可用于传输需要 **保密或简短** 的信息。本质上，编码就是交流。从计算机的角度看，编码是一种人与机器传递信息的方式。莫尔斯电码就是一种经典的编码，用点（dot）和划（dash）的组合来对应不同的字母。例如，求救信号SOS就是一个易于记忆的莫尔斯电码（··· --- ···）。

事实上，两个不同的事物，只要经过适当的组合，就可以表示所有类型的信息。而组合的长度，就决定了码字的数目。例如，长度为 1 的组合只能表示 2 种码字（单个点或者单个划），长度为 2 的组合能表示 4 种码字，（点点、点划、划点、划划）。从实践中我们发现，点和划的数目跟码字的数目的函数关系为 2 的幂次方，如下表：

点和划的数目|码字的数目
---|---
1|2
2|4 (2^2)
3|8 (2^3)
4|16 (2^4)
5|32 (2^5)
6|64(2^6)
n| 2^n

<!--more-->

# 优先码

路易斯·布莱叶（Louis
 Braille）是19世纪法国的一个盲人，他改良的盲文实际上是一种6位的二进制码（6个点），从上表可以知道，6个点可以有64种可能的编排方式。而布莱叶盲文中有很大一部分码字会根据上下文的不同有着双重身份，例如，某一个位置的点点上了，就代表数字标识状态，不点上，就切换回字母。这跟我们键盘的 Caps Lock 键很像，按下 Caps Lock 键，输入的就是大写字母，否则是小写。**像这样的编码通常称作优先码(precedence codes) 或 换挡码（shift codes）**。

# 进制

在我们熟悉的十进制中，数字3572表示2个1 + 7个10 + 5个100 + 3个1000。同理可推，在八进制中3582表示2个1 + 7个8 + 5个64 + 3个512 。**百位是个位和十位的乘的结果**。在二进制中，位数从右到左，依次为1的个数，2的个数，4的个数，8的个数。例如，1101表示1个1 + 0个2 + 1个4 + 1个8，结果为十进制的13。之所以在计算机中要用二进制，是从电报机或者灯泡中得到的启示，开/关即可传递信息，再用它们的组合来编码。

# 电报机和继电器

电报机的原理很简单，只要在线路的一端采取一些措施，使线路的另一端发生某种变化，能够实现这种功能的及其就是一个简易的电报机了。电磁铁是电报机的基础，在一根铁棒上面用细导线绕几百圈，然后给导线通电，这根铁棒就成了电磁铁。我们可以用一个开关和电池来给导线通电，导线一直铺设到远处，一旦通电，远处的铁棒就有了磁性，磁力把旁边的活动横杠拉动，发出“滴”的声音。这样的设备，就是一个电报机。

我们知道，导体越长，电阻越大。如果电报机两端的距离很远，那我们的电池可能供不了电，怎么办呢？这时候就要用到继电器了。继电器用传进来的电流去驱动电磁铁，拉动金属杠，金属杠又作为一个开关，连接了新的电池和导线，传递到另一个远处。这样，我们就可以用几个继电器，来延长电报机的传输距离。

继电器就是这样一种用于放大微弱信号来生成强信号的机器。继电器是需要供电的。

# 布尔代数和逻辑表达式

布尔代数是19世纪英格兰数学家乔治·布尔提出的数学理论。传统的代数，操作数代表数字，算子(+、-、×、÷)表示如何运算，而在布尔代数的世界里，操作数是类（class），一个类就是一个事物的群体，也被称为集（set）。“+”表示并集（∪），“×”表示交集（∩）。如果用F表示雌猫，用W表示白猫，那么 F×W 表示白色的雌猫。为了方便，我们用大写英文 OR 来代替“+”，用 AND 代替“×”，用 NOT 代替 “1-”（从全集中去掉某些元素）。

如果我们用F表示雌猫，M表示雄猫，W表示白猫，B表示黑猫。现在我们想得到白色的雌猫，在备选项F、M、W、B的一些表达式中，F和W可以用 1 表示，而其他选项为 0 。这种表示大大简化了表达式。

有了布尔代数和逻辑表达式及其简化表示之后，我们就可以用灯泡、导线、开关来制造我们的AND、OR、NOT计算器了。这其实就是计算机的原型。

# 逻辑门

我们可以给由灯泡、导线、开关组成的电路加多几个支路和开关，以实现更加复杂的功能。比如，闭合两个开关灯泡才会亮的 AND 逻辑电路，闭合两个中的任意一个开关灯泡就会亮的 OR 逻辑电路，以及不闭合开关灯泡才会亮的 NOT 电路。

但是要实现更加复杂的功能，就得用到继电器了。继电器可以作为一个电流控制而非人工控制的开关，那么我们用不同的接法连接继电器，最终就能实现不同的效果。比如我们串联两个继电器，继电器A的电源开关打开，继电器B的电源开关也打开，然后在起始段通电，这样，电流从起始端到继电器A，再到继电器B，最后到灯泡，导致灯泡亮。而灯泡亮的必要条件是继电器A和继电器B的开关都打开，实际上这就是一个 AND 逻辑电路。

同样，我们可以换一种接法，实现 OR 或 NOT 逻辑电路。再把简单逻辑电路组合成复杂逻辑电路，实现各种各样的功能。

在数字电路中，有与门、或门、与非门、或非门四种逻辑门和反向器（NOT）。这些东西组合在一起就是一个原始的继电器。

# 二进制加法器

如果想搭建一台计算机，首先要造出可以计算两数之和的器件。事实上，加法计算是计算机唯一要做的工作。只要我们实现了加法，就可以用加法来实现减法、乘法、除法等等。

二进制数相加，当遇到1+1=10时，结果10的1表示进位位，10的0表示加法位。我们可以用与门来实现进位位的表示。将一个与非门和一个或门连接到共同的输入，再加一个与门，就可以用来实现加法位的表示。这种接法叫做异或门 XOR（奇数个1位1，偶数个1为0）。

现在，与门的结果表示进位位，异或门的结果表示加法位，我们将这两个逻辑门接入共同的输入。这就是一个半加器（Half Adder）。半加器的缺陷是，只能实现1位的二进制数相加，多于1位进位位并不会向左累积。

事实上，二进制数相加，是三个位的相加，输入A、输入B和进位输入。用两个半加器和一个或门就能实现。这种组合称为全加器（Full Adder）。把8个全加器串联起来，就能实现8位二进制数的加法了。最低有效位的一对数字相加所得出的进位输出，作为下一对数字的进位位，以此类推。

回归本质，全加器->半加器->逻辑门->继电器，这一切只不过是许多继电器的组合而已！尽管现在的计算机已经用晶体管代替继电器，但原理是一样的。

未完待续...

---

- 参考资料：《编码——隐匿在计算机软硬件背后的语言》
