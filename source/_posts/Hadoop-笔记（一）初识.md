---
title: Hadoop 笔记（一）初识
comments: true
categories: 大数据
tags: Hadoop
abbrlink: e2142b57
date: 2018-03-14 18:47:46
---

当数据量变大的时候，一台机器完成一个问题要计算好久好久。这时候就需要多台机器并行运算。然而，每台机器不能用单台机器运行的算法，自己算自己的。而是要有不同的分工，联合起来共同算完这个问题。

Hadoop就是这样的一个大数据处理框架。

---

# Hadoop 工作原理

假设我们要统计一本10000页的书里面，"apple"、"banana"、"orange"这三个单词出现的次数。由于规模很大，用一台机器来算，要算很久。我们能不能把规模缩小，交给多台机器去算呢？

我们想到，可以拿4台服务器，假设为1，2，3，4，每台服务器计算2500页，各自算各自的。

好了，现在每台服务器把各自负责的2500页统计完了。 但我们关心的是10000页这个总量里面单词出现的次数，而不是4个独立的2500页。

这4个2500页的结果分别保存在1，2，3，4四台服务器上。我们现在要想办法合并结果。

于是我们找来另外三台服务器，假设为A，B，C。

让 A 计算在机器1，2，3，4上面 "apple" 单词出现的总次数。

让 B 计算在机器1，2，3，4上面 "banana" 单词出现的总次数。

让 C 计算在机器1，2，3，4上面 "orange" 单词出现的总次数。

这样，我们就知道每个单词出现的总次数了。

<!-- more -->*

## MapReduce

以上就是 Hadoop 简单的基本原理。我们称为`mapReduce` 模型。这个模型分为三个阶段。

**Map阶段**：每台机器先处理本机上的数据，像图1中各个机器计算本机的文件中关键字的个数。

**Shuffle阶段**：各个机器处理完自己的数据后，把他们的结果汇总。

**Reduce阶段**：统计出现总次数。

---

# Hadoop Distribute Filesystem (HDFS)

当数据集大小超过一台计算机的存储能力时，就有必要对它进行分区（partition）并存储到多台计算机上。管理网络中跨多台计算机存储的文件系统称为`分布式文件系统（distribute filesystem）`。

Hadoop 自带一个分布式文件系统，称为 HDFS。

## HDFS 的设计

包括可存储超大文件、流式数据访问、用于商用硬件（指的是普通硬件而不是精密昂贵的硬件）、低时间延迟的数据访问、大量的小文件、单用户写入和只添加 等设计特点。

## HDFS 的一些术语

* **数据块**： HDFS上的文件被划分为多个分块（chunk），作为独立的存储单元
* **namenode**：管理节点，管理文件系统的命名空间，也就是用于维护系统树和树内所有的文件和目录的东西。namenode十分重要，因此需要实现容错。一般在另一台单独计算机配置辅助namenode（secondarynamenode）
* **datanode**：工作节点，存储并检索数据块。定期向 namenode 发心跳包。

![](../../../../images/hadoop/node.png)

---

# Yet Another Resource Negotiator (YARN)

YARN 是 Hadoop 的集群资源管理系统。 YARN 提供请求和使用集群资源的API。但很少用于用户代码，因为在 YARN 之上的如MapReduce、Spark等分布式计算框架向用户隐藏了资源管理的细节。

一般来说，HDFS在Storage底层、YARN在Compute中间层，往上的Application上层才是MapReduce、Spark等计算框架。（甚至Application之上还能再封装一层，如Pig、Hive等）

Hadoop有两类长期运行的守护进程：

* **资源管理器**：管理集群上资源的使用
* **节点管理器**：运行在集群中所有节点上切能够启动和监控容器的东西

 YARN 则是管理这两个守护进程的。
