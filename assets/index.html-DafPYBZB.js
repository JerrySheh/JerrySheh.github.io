import{_ as t,c as n,f as l,d,e as r,b as e,a as i,r as p,o as h}from"./app-D22ydJtp.js";const k={};function o(c,s){const a=p("font");return h(),n("div",null,[s[1]||(s[1]=l(`<p>MySQL 使用文件系统的目录和文件来保存数据库和表的定义，因此大小写敏感与平台相关。在 Windows 下大小写不敏感，而类Unix系统则是敏感的。</p><hr><h1 id="ubuntu-18-04-安装-mysql-5-7" tabindex="-1"><a class="header-anchor" href="#ubuntu-18-04-安装-mysql-5-7"><span>Ubuntu 18.04 安装 Mysql 5.7</span></a></h1><p>注：如果要安装 Mysql 8.0 ，可以参考 <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/" target="_blank" rel="noopener noreferrer">官方文档</a></p><h2 id="卸载和安装" tabindex="-1"><a class="header-anchor" href="#卸载和安装"><span>卸载和安装</span></a></h2><p>干净卸载后安装</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>sudo apt-get --purge remove mysql-server mysql-common mysql-client</span></span>
<span class="line"><span>sudo apt-get install mysql-server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 root 密码</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysqladmin -u root password your-new-password</span></span>
<span class="line"><span>sudo /etc/init.d/mysql restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>或者，直接运行安全脚本配置</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>sudo mysql_secure_installation</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="安装完毕后发现没有登录权限" tabindex="-1"><a class="header-anchor" href="#安装完毕后发现没有登录权限"><span>安装完毕后发现没有登录权限</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>ERROR 1045: Access denied for user: &#39;root@localhost&#39; (Using</span></span>
<span class="line"><span>password: YES)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>首先无密码登录</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>sudo mysql -u root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后查看当前用户，删除后重新创建 ROOT 账户，并授权</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> User,Host </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> mysql</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">user</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DROP</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> USER </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">@</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">localhost</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> USER </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">@</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> IDENTIFIED </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BY</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">123456</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> GRANT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ALL PRIVILEGES </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">@</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WITH</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> OPTION</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="允许远程访问" tabindex="-1"><a class="header-anchor" href="#允许远程访问"><span>允许远程访问</span></a></h2><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> GRANT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ALL PRIVILEGES </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TO</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">@</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WITH</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> GRANT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> OPTION</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">mysql</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>打开 /etc/mysql/mysql.conf.d/mysqld.cnf 文件</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>把 bind-address 改为 0.0.0.0</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>#bind-address = 127.0.0.1</span></span>
<span class="line"><span>bind-address = 0.0.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="修改root密码" tabindex="-1"><a class="header-anchor" href="#修改root密码"><span>修改ROOT密码</span></a></h1><h2 id="方法1-用set-password命令" tabindex="-1"><a class="header-anchor" href="#方法1-用set-password命令"><span>方法1： 用SET PASSWORD命令</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>MySQL -u root</span></span>
<span class="line"><span>mysql&gt; SET PASSWORD FOR &#39;root&#39;@&#39;localhost&#39; = PASSWORD(&#39;newpass&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="方法2-用mysqladmin" tabindex="-1"><a class="header-anchor" href="#方法2-用mysqladmin"><span>方法2：用mysqladmin</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysqladmin -u root password &quot;newpass&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果root已经设置过密码，采用如下方法</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysqladmin -u root password oldpass &quot;newpass&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h1 id="如何导入数据库文件" tabindex="-1"><a class="header-anchor" href="#如何导入数据库文件"><span>如何导入数据库文件</span></a></h1><p>假设我们已经有了一个数据库脚本， projectDB.sql，如何导入到MySQL？</p><p>方法一：直接通过 mysql 命令运行</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysql -u root -p123456 --port 3306 &lt; /home/jerrysheh/projectDB.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>方法二：登录 mysql 后使用 source 命令</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysql&gt;create database &lt;database-name&gt;;</span></span>
<span class="line"><span>mysql&gt;use &lt;database-name&gt;;</span></span>
<span class="line"><span>mysql&gt;source /home/jerrysheh/projectDB.sql;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="解决导入慢的问题" tabindex="-1"><a class="header-anchor" href="#解决导入慢的问题"><span>解决导入慢的问题</span></a></h2><p>当数据库非常大（&gt;100M）时，导入时间可能要花费几小时，优化方式如下：</p><p>假设要讲A数据库的数据导入到B数据库</p><p>1、首先确定目标库(B)的参数值，登录数据库B，执行以下命令</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>mysql&gt;show variables like &#39;max_allowed_packet&#39;;</span></span>
<span class="line"><span>mysql&gt;show variables like &#39;net_buffer_length&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>2、根据参数值，在A数据库中使用 mysqldump 命令，如：</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>C:\\Program Files\\MySQL\\MySQL Server 8.0\\bin&gt;mysqldump.exe -uroot -p mall  -e --max_allowed_packet=67108864 --net_buffer_length=16384 &gt; mall.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>各个参数的意思：</p><ul><li><strong>-e</strong>： 使用包括几个VALUES列表的多行INSERT语法;</li><li><strong>--max_allowed_packet=XXX</strong>：客户端/服务器之间通信的缓存区的最大大小;</li><li><strong>--net_buffer_length=XXX</strong>：TCP/IP和套接字通信缓冲区大小,创建长度达net_buffer_length的行。</li></ul><p>注意：max_allowed_packet和net_buffer_length不能比目标数据库的设定数值大，否则可能出错。</p><p>3、登录数据库B，执行 source 命令导入</p><hr><h1 id="修改默认字符集" tabindex="-1"><a class="header-anchor" href="#修改默认字符集"><span>修改默认字符集</span></a></h1><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> DATABASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> db_name </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CHARACTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> utf8mb4;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> db_name </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">DEFAULT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CHARACTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> utf8mb4;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ALTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> db_name CONVERT </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TO</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CHARACTER</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> utf8mb4;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="改变事务的隔离级别" tabindex="-1"><a class="header-anchor" href="#改变事务的隔离级别"><span>改变事务的隔离级别</span></a></h1><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SET</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TRANSACTION</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ISOLATION</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LEVEL</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> READ</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> COMMITTED</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="如何修改-mysql-隔离级别" tabindex="-1"><a class="header-anchor" href="#如何修改-mysql-隔离级别"><span>如何修改 MySQL 隔离级别</span></a></h3><ol><li>查看当前会话隔离级别</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">select</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> @@tx_isolation;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>查看系统当前隔离级别</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">select</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> @@</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">global</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">tx_isolation</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>设置当前会话隔离级别</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">set</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> session</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> transaction</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> isolatin </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">level</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> repeatable</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> read</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>设置系统当前隔离级别</li></ol><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">set</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> global</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> transaction</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> isolation</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> level</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> repeatable</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> read</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h1 id="mysql-线程状态" tabindex="-1"><a class="header-anchor" href="#mysql-线程状态"><span>MySQL 线程状态</span></a></h1><p>使用 <code>SHOW FULL PROCESSLIST;</code> 命令查看当前正在运行的线程，常见的状态如下：</p><table><thead><tr><th>状态</th><th>释义</th></tr></thead><tbody><tr><td>Checking table</td><td>正在检查数据表(这是自动的)</td></tr><tr><td>Closing tables</td><td>正在将表中修改的数据刷新到磁盘中，同时正在关闭已经用完的表。这是一个很快的操作，如果不是这样的话，就应该确认磁盘空间是否已经满了或者磁盘是否正处于重负中。</td></tr><tr><td>Connect Out</td><td>复制从服务器正在连接主服务器</td></tr><tr><td>Copying to tmp table on disk</td><td>由于临时结果集大于 tmp_table_size，正在将临时表从内存存储转为磁盘存储以此节 省内存</td></tr><tr><td>Creating tmp table</td><td>正在创建临时表以存放部分查询结果</td></tr><tr><td>deleting from main table</td><td>服务器正在执行多表删除中的第一部分，即删除主表，并保存要用于删除关联表的相关列和偏移量</td></tr><tr><td>deleting from reference tables</td><td>服务器正在执行多表删除中的第二部分，正在删除其他表的记录</td></tr><tr><td>Flushing tables</td><td>正在执行 FLUSH TABLES，等待其他线程关闭数据表</td></tr><tr><td>Killed</td><td>发送了一个kill请求给某线程，那么这个线程将会检查kill标志位，同时会放弃下一个kill请求。MySQL会在每次的主循环中检查kill标志位，不过有些情况下该线程可能会过一小段才能死掉。如果该线程程被其他线程锁住了，那么kill请求会在锁释放时马上生效</td></tr><tr><td>Locked</td><td>被其他查询锁住了</td></tr></tbody></table>`,68)),d(a,{color:"red"},{default:r(()=>s[0]||(s[0]=[e(" Sending data ")])),_:1}),s[2]||(s[2]=e(" | 正在处理 SELECT 查询的记录，同时正在把结果发送给客户端。由于在此状态期间发生的操作往往会执行大量磁盘访问（读取），因此它通常是给定查询生命周期内运行时间最长的状态")),s[3]||(s[3]=i("p",null,"Sorting for group | 正在为 GROUP BY 做排序 Sorting for order | 正在为 ORDER BY 做排序 Opening tables | 正尝试打开一个表。这个过程应该会很快，除非受到其他因素的干扰。例如，在执 ALTER TABLE 或 LOCK TABLE 语句行完以前，数据表无法被其他线程打开 Removing duplicates | 正在执行一个 SELECT DISTINCT 方式的查询，但是MySQL无法在前一个阶段优化掉那些重复的记录。因此，MySQL需要再次去掉重复的记录，然后再把结果发送给客户端。 Reopen table | 获得了对一个表的锁，但是必须在表结构修改之后才能获得这个锁。已经释放锁，关闭数据表，正尝试重新打开数据表 Repair by sorting | 修复指令正在排序以创建索引 Repair with keycache | 修复指令正在利用索引缓存一个一个地创建新索引。它会比 Repair by sorting 慢些 Searching rows for update | 正在讲符合条件的记录找出来以备更新。它必须在 UPDATE 要修改相关的记录之前就完成了 Sleeping | 正在等待客户端发送新请求 System lock | 正在等待取得一个外部的系统锁。如果当前没有运行多个mysqld服务器同时请求同一个表，那么可以通过增加 --skip-external-locking参数来禁止外部系统锁",-1)),s[4]||(s[4]=i("p",null,[e("更多细节可参考"),i("a",{href:"https://dev.mysql.com/doc/refman/5.7/en/general-thread-states.html",target:"_blank",rel:"noopener noreferrer"},"官方文档")],-1)),s[5]||(s[5]=i("hr",null,null,-1)),s[6]||(s[6]=i("p",null,"参考：",-1)),s[7]||(s[7]=i("ul",null,[i("li",null,[i("a",{href:"https://www.51cto.com/article/540613.html",target:"_blank",rel:"noopener noreferrer"},"MySQL SQL慢查询优化经历与处理方案")])],-1))])}const m=t(k,[["render",o],["__file","index.html.vue"]]),y=JSON.parse('{"path":"/db/br54lcyl/","title":"MySQL运维","lang":"zh-CN","frontmatter":{"title":"MySQL运维","categories":["数据库","高性能MySQL"],"tags":["database"],"abbrlink":"9faffbfd","createTime":"2018/03/22 21:00:00","permalink":"/db/br54lcyl/","description":"MySQL 使用文件系统的目录和文件来保存数据库和表的定义，因此大小写敏感与平台相关。在 Windows 下大小写不敏感，而类Unix系统则是敏感的。 Ubuntu 18.04 安装 Mysql 5.7 注：如果要安装 Mysql 8.0 ，可以参考 官方文档 卸载和安装 干净卸载后安装 设置 root 密码 或者，直接运行安全脚本配置 安装完毕后发现...","head":[["meta",{"property":"og:url","content":"https://jerrysheh.com/db/br54lcyl/"}],["meta",{"property":"og:site_name","content":"Jerry"}],["meta",{"property":"og:title","content":"MySQL运维"}],["meta",{"property":"og:description","content":"MySQL 使用文件系统的目录和文件来保存数据库和表的定义，因此大小写敏感与平台相关。在 Windows 下大小写不敏感，而类Unix系统则是敏感的。 Ubuntu 18.04 安装 Mysql 5.7 注：如果要安装 Mysql 8.0 ，可以参考 官方文档 卸载和安装 干净卸载后安装 设置 root 密码 或者，直接运行安全脚本配置 安装完毕后发现..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-20T05:02:32.000Z"}],["meta",{"property":"article:tag","content":"database"}],["meta",{"property":"article:modified_time","content":"2024-10-20T05:02:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL运维\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-20T05:02:32.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"卸载和安装","slug":"卸载和安装","link":"#卸载和安装","children":[]},{"level":2,"title":"安装完毕后发现没有登录权限","slug":"安装完毕后发现没有登录权限","link":"#安装完毕后发现没有登录权限","children":[]},{"level":2,"title":"允许远程访问","slug":"允许远程访问","link":"#允许远程访问","children":[]},{"level":2,"title":"方法1： 用SET PASSWORD命令","slug":"方法1-用set-password命令","link":"#方法1-用set-password命令","children":[]},{"level":2,"title":"方法2：用mysqladmin","slug":"方法2-用mysqladmin","link":"#方法2-用mysqladmin","children":[]},{"level":2,"title":"解决导入慢的问题","slug":"解决导入慢的问题","link":"#解决导入慢的问题","children":[{"level":3,"title":"如何修改 MySQL 隔离级别","slug":"如何修改-mysql-隔离级别","link":"#如何修改-mysql-隔离级别","children":[]}]}],"readingTime":{"minutes":5.51,"words":1654},"git":{"createdTime":1729400552000,"updatedTime":1729400552000,"contributors":[{"name":"jerrysheh","email":"jerrysheh@gmail.com","commits":1}]},"autoDesc":true,"filePathRelative":"notes/db/2.MySQL/4.MySQL运维.md"}');export{m as comp,y as data};
